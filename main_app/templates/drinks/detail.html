{% extends 'base.html' %} {% block content %}

<h1 class="h1 text-center">Drink Details</h1>

<section class="col-8 offset-2">
  <table class="table-dark">
    <tbody>
      {% if user.is_authenticated %}
      <tr>
        {% for photo in drink.photo_set.all %}
        <td><img class="responsive-img card-panel" src="{{photo.url}}" /></td>
      </tr>
      {% endfor %}
      <form
        action="{% url 'add_photo' drink.id %}"
        enctype="multipart/form-data"
        method="POST"
        class="card-panel"
      >
        {% csrf_token %}
        <input type="file" name="photo-file" />
        <br />
        <br />
        <input type="submit" value="Upload Photo" />
      </form>
      {% endif %}

      <tr>
        <td>Cocktail:</td>
        <td>{{ drink.name }}</td>
      </tr>
      <tr>
        <td>Ingredients:</td>
        <td>{{ drink.get_ingredients_display }}</td>
      </tr>
      <tr>
        <td>Instructions:</td>
        <td>{{ drink.instructions }}</td>
      </tr>
    </tbody>
  </table>
</section>

{% if user.is_authenticated %}
<br>
<br>
<br>
<section class="row col-8 offset-2">
  <div class="col">
    <table class="table text-light">
      <thead>
        <tr>
          <td><strong>Rating</strong></td>
          <td><strong>Review</strong></td>
          <td><strong>Date</strong></td>
        </tr>
      </thead>
      {% if drink.review_set.count %} {% for rev in drink.review_set.all%}
      <tbody>
        <tr>
          <td>{{rev.get_rating_display}}</td>
          <td>{{rev.review}}</td>
          <td>{{rev.date}}</td>
        </tr>
      </tbody>
      {% endfor %}
      </table>
      {% else %}
    </table>
    <p>Tell us your cocktail story!</p>
    {% endif %}
  </div>
  <div class="col form-group ">
    <form action="{% url 'add_review' drink.id %}" method="POST">
      {% csrf_token %} 
      {{review_form.as_p}}
      <div class="d-flex justify-content-end">
          <button class="btn btn-outline-primary" type="submit">
          Add A Review
          </button>
      </div>
    </form>
  </div>
</section>
{% endif %}


<div class="col-8 offset-2">
  {% if drink.user_id == user.id %}
  <a href="{% url 'drinks_update' drink.id %}" class="btn btn-primary">Edit</a>
  <a href="{% url 'drinks_delete' drink.id %}" class="btn btn-danger">Delete</a>
  {% else %} {% endif %} {% if user.is_authenticated %} {% if drink in favs %}
  <a href="{% url 'fav_add' drink.id%}" class="btn btn-warning">
    Remove Favorite
  </a>
  {% else %}
  <a href="{% url 'fav_add' drink.id%}" class="btn btn-warning">Add Favorite</a>
  {% endif %} {% endif %}
  <a href="/index" class="btn btn-outline-danger">GO BACK</a>
</div>

{% endblock content %}
